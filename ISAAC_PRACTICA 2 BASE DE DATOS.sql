CREATE DATABASE VENTAS
USE VENTAS

--TABLA PROVEEDORES
CREATE TABLE PROVEEDORES
(
P# NVARCHAR(5),
PNOMBRE NVARCHAR(15),
CATEGORIA INT,
CIUDAD VARCHAR(15),
PRIMARY KEY (P#) --ESTE NO ES UNA COLUMNA
)
SELECT * FROM PROVEEDORES

--INSERTANDO REGISTROS A LA TABLA PROVEEDORES

INSERT INTO PROVEEDORES (P#,PNOMBRE,CATEGORIA,CIUDAD)VALUES 
('P1','CARLOS','20','SEVILLA')

INSERT INTO PROVEEDORES (P#,PNOMBRE,CATEGORIA,CIUDAD)VALUES 
('P2','JUAN','10','MADRID')

INSERT INTO PROVEEDORES (P#,PNOMBRE,CATEGORIA,CIUDAD)VALUES 
('P3','JOSE','30','SEVILLA')

INSERT INTO PROVEEDORES (P#,PNOMBRE,CATEGORIA,CIUDAD)VALUES 
('P4','INMA','20','SEVILLA')

INSERT INTO PROVEEDORES (P#,PNOMBRE,CATEGORIA,CIUDAD)VALUES 
('P5','EVA','30','CACERES')




--CREANDO LA TABLA COMPONENTES
CREATE TABLE COMPONENTES

(

C# NVARCHAR(5),

CNOMBRE NVARCHAR(5),

COLOR NVARCHAR(5),

PESO NUMERIC (4,2),

CIUDAD NVARCHAR(15),

PRIMARY KEY (C#)

)
SELECT*FROM COMPONENTES
--INSERTANDO REGISTROS A LA TABLA COMPONENTES

INSERT INTO COMPONENTES(C#,CNOMBRE,COLOR,PESO,CIUDAD)VALUES ('C1','X3A','ROJO','12','SEVILLA')
INSERT INTO COMPONENTES(C#,CNOMBRE,COLOR,PESO,CIUDAD)VALUES ('C2','B85','VERDE','17','MADRID')
INSERT INTO COMPONENTES(C#,CNOMBRE,COLOR,PESO,CIUDAD)VALUES ('C3','C4B','AZUL','17','MALAGA')
INSERT INTO COMPONENTES(C#,CNOMBRE,COLOR,PESO,CIUDAD)VALUES ('C4','C4B','ROJO','14','SEVILLA')
INSERT INTO COMPONENTES(C#,CNOMBRE,COLOR,PESO,CIUDAD)VALUES ('C5','VT8','AZUL','12','MADRID')
INSERT INTO COMPONENTES(C#,CNOMBRE,COLOR,PESO,CIUDAD)VALUES ('C6','C30','ROJO','19','SEVILLA')


--CREANDO LA TABLA ARTICULOS

CREATE TABLE ARTICULOS

(

T# NVARCHAR(5),

TNOMBRE NVARCHAR(15),

CIUDAD NVARCHAR(15),

PRIMARY KEY (T#)

)

--INSERTANDO REGISTROS A LA TABLA ARTICULOS

INSERT INTO ARTICULOS(T#,TNOMBRE,CIUDAD)VALUES
('T1','CLASIFICADORA','MADRID')
INSERT INTO ARTICULOS(T#,TNOMBRE,CIUDAD)VALUES
('T2','PERFORADORA','MALAGA')
INSERT INTO ARTICULOS(T#,TNOMBRE,CIUDAD)VALUES
('T3','LECTORA','CACERES')
INSERT INTO ARTICULOS(T#,TNOMBRE,CIUDAD)VALUES
('T4','CONSOLA','CACERES')
INSERT INTO ARTICULOS(T#,TNOMBRE,CIUDAD)VALUES
('T5','MEZCLADORA','SEVILLA')
INSERT INTO ARTICULOS(T#,TNOMBRE,CIUDAD)VALUES
('T6','TERMINAL','BARCELONA')
INSERT INTO ARTICULOS(T#,TNOMBRE,CIUDAD)VALUES
('T7','CINTA','SEVILLA')

SELECT*FROM ARTICULOS




--CREANDO LA TABLA ENVIOS

CREATE TABLE ENVIOS

(

P# NVARCHAR(5),

C# NVARCHAR(5),

T# NVARCHAR(5),

CANTIDAD INT,

CONSTRAINT FK_ENVIOS_PROVEEDORES FOREIGN KEY (P# )REFERENCES PROVEEDORES (P# )ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT FK_ENVIOS_COMPONENTES FOREIGN KEY (C# )REFERENCES COMPONENTES (C# )ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT FK_ENVIOS_ARTICULOS FOREIGN KEY (T# )REFERENCES ARTICULOS (T# )ON DELETE CASCADE ON UPDATE CASCADE

)

--INSERTANDO REGISTROS A LA TABLA ENVIOS

INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P1','C1','T1',200)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P1','C1','T4',700)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P2','C3','T1',400)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P2','C3','T2',200)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P2','C3','T3',200)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P2','C3','T4',500)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P2','C3','T5',600)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P2','C3','T6',400)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P2','C3','T7',800)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P2','C5','T2',100)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P3','C3','T1',200)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P3','C4','T2',500)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P4','C6','T3',300)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P4','C6','T7',300)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C2','T2',200)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C2','T4',100)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C5','T4',500)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C5','T7',100)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C6','T2',200)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C1','T4',100)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C3','T4',200)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C4','T4',800)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C5','T5',400)
GO
INSERT INTO ENVIOS(P#,C#,T#,CANTIDAD)VALUES ('P5','C6','T4',500)
GO

SELECT *FROM ENVIOS

/*

PROVEEDORES.- Representa los datos de proveedores de componentes para la fabricación de artículos y su ciudad de residencia.

COMPONENTES.- Indica la información de piezas utilizadas en la fabricación de diferentes artículos, indicándose el lugar de fabricación de dichos componentes.

ARTICULOS.- Información sobre los diferentes artículos que se fabrican y el lugar de montaje del mismo.

ENVIOS.- Suministros realizados por los diferentes proveedores de determinadas cantidades de componentes asignadas para la elaboración del artículo correspondiente.

*/


EJERCICIOS

-- Obtener todos los detalles de todos los artículos de CACERES.

SELECT * FROM ARTICULOS WHERE CIUDAD='CACERES'

--Obtener todos los valores de P# para los proveedores que abastecen el artículo T1.

SELECT * FROM PROVEEDORES,ARTICULOS WHERE T# ='T1'

--Obtener la lista de pares de atributos (COLOR, CIUDAD) de la tabla componentes eliminando los pares duplicados.

SELECT DISTINCT COLOR,CIUDAD FROM COMPONENTES

--Obtener de la tabla de artículos los valores de T# y CIUDAD donde el nombre de la ciudad acaba en D o contiene al menos una E.

SELECT T#,CIUDAD FROM ARTICULOS WHERE CIUDAD LIKE '%D' OR CIUDAD LIKE '%e%'

--Obtener los valores de P# para los proveedores que suministran para el artículo T1 El componente C1.

SELECT P#,T#,C# FROM ENVIOS WHERE T# ='T1' AND C#= 'C1'

--Obtener los valores de TNOMBRE en orden alfabético para los artículos abastecidos por el proveedor P1.

SELECT DISTINCT TNOMBRE,P# FROM ARTICULOS,ENVIOS WHERE P#= 'P1' ORDER BY TNOMBRE

--CREACIÓN DE LA BASE DE DATOS ORDENADORES

CREATE DATABASE ORDENADORES
GO
USE ORDENADORES

CREATE TABLE PRODUCTOS

(

#Fabricante NVARCHAR(5),

#Modelo NVARCHAR (30),

Tipo NVARCHAR(25),

PRIMARY KEY(#MODELO)

)

--CREACIÓN DE LA TABLA PC

CREATE TABLE PC

(

#Modelo NVARCHAR (30),

Velocidad NUMERIC(4,2),

RAM NVARCHAR(15),

HD INT,

CD NVARCHAR(20),

Precio NUMERIC(6,2)

PRIMARY KEY (#MODELO)

)

--ELACIONANDO LAS TABLAS PC Y PRODUCTOS CON ELIMINACION Y ACTUALIZACION EN CASCADA

ALTER TABLE PC ADD CONSTRAINT PROD_PC FOREIGN KEY (#MODELO)
 REFERENCES PRODUCTOS(#MODELO)ON DELETE CASCADE ON UPDATE CASCADE

 --CREACIÓN DE LA TABLA IMPRESORAS

 CREATE TABLE IMPRESORA

(

#Modelo NVARCHAR(30),

Color BIT,

Tipo NVARCHAR(25),

Precio NUMERIC(6,2)

PRIMARY KEY (#Modelo)

)

--RELACIONANDO LAS TABLAS IMPRESORA Y PRODUCTOS CON ELIMINACION Y ACTUALIZACION EN CASCADA


ALTER TABLE IMPRESORA ADD CONSTRAINT PROD_IMPRE FOREIGN KEY (#MODELO) 
REFERENCES PRODUCTOS(#MODELO)ON DELETE CASCADE ON UPDATE CASCADE
--INSERTANDO LOS DATOS A LA TABLA PRODUCTOS
INSERT INTO PRODUCTOS(#Fabricante,#Modelo,Tipo)VALUES ('ACER','Acer TM8473T-6691','LAPTOP')
GO
INSERT INTO PRODUCTOS(#Fabricante,#Modelo,Tipo)VALUES ('HP','TM8573T-6470','LAPTOP')
GO
INSERT INTO PRODUCTOS(#Fabricante,#Modelo,Tipo)VALUES ('HP','HP DESKJET 470C','LASER')
GO
INSERT INTO PRODUCTOS(#Fabricante,#Modelo,Tipo)VALUES ('CANON','CANON 440','INYECCIÓN')
GO
INSERT INTO PRODUCTOS(#Fabricante,#Modelo,Tipo)VALUES ('ACER','Acer PM8473T-85692','DESKTOP')
GO
INSERT INTO PRODUCTOS(#Fabricante,#Modelo,Tipo)VALUES ('HP','TM8573T-8125','LAPTOP')
GO
INSERT INTO PRODUCTOS(#Fabricante,#Modelo,Tipo)VALUES ('HP','HP DESKJET 9600C','LASER')
GO
INSERT INTO PRODUCTOS(#Fabricante,#Modelo,Tipo)VALUES ('CANON','CANON 520C','INYECCIÓN')

--INSERTANDO LOS DATOS A LA TABLA IMPRESORAS

INSERT INTO IMPRESORA(#MODELO,COLOR,TIPO,PRECIO)VALUES ('HP DESKJET 9600C',0,'LASER',3000)
GO
INSERT INTO IMPRESORA(#MODELO,COLOR,TIPO,PRECIO)VALUES ('CANON 520C',1,'INYECCIÓN',1500)
GO
SELECT *FROM IMPRESORA


--NSERTANDO LOS DATOS A LA TABLA PC

INSERT INTO PC(#MODELO,VELOCIDAD,RAM,HD,CD,PRECIO)VALUES ('Acer TM8473T-6691',3.5,'4 GB',500,'DVD WR 16X',500)
GO
INSERT INTO PC(#MODELO,VELOCIDAD,RAM,HD,CD,PRECIO)VALUES ('TM8573T-6470',3.0,'4 GB',520,'DVD WR 16X',400)
GO
SELECT *FROM PC

--Encontrar el modelo, velocidad y tamaño de disco duro (hd) de todos los PC’s  cuyo precio sea inferior a $1600.

SELECT #MODELO,VELOCIDAD,HD,PRECIO FROM PC WHERE PRECIO <1600

--Repetir la consulta de (a), pero cambiando el nombre a las columnas velocidad como Megaherzios y hd como Gigabytes.

SELECT #MODELO,VELOCIDAD [MEGAHERZIOS],HD [GIBABYTES],PRECIO FROM PC WHERE PRECIO <1600

--Encontrar todas las filas de la tabla de Impresoras que son en color. El valor de la columna color es booleano con los valores ’V’ y ’F’.

SELECT *FROM IMPRESORA WHERE COLOR= 1 OR COLOR= 0

--Encontrar la velocidad media de los PC’s.

SELECT AVG(VELOCIDAD) 'MEDIA VELOCIDAD PC' FROM PC

--Decir los fabricantes y la velocidad de los PC’s con disco duro de tamaño mayor o igual a 1 Gigabyte.
SELECT DISTINCT #FABRICANTE,VELOCIDAD, HD [GIGABYTES EN HD]FROM PRODUCTOS, PC WHERE HD>1

--Encontrar los fabricantes de los PC’s con velocidad superior a 160 MHz.

SELECT DISTINCT #FABRICANTE,VELOCIDAD [GIGAHERTZ] FROM PRODUCTOS, PC WHERE VELOCIDAD> (160/1024)


--Dadas las siguientes tablas, dar una expresión SQL para cada una de las siguientes consultas:

/*
Vive (#nombre, calle, ciudad)

Trabaja (#nombre, #compania,  salario)

Situada (#compania, ciudad)

Dirige (#nombre, #nombre_director)
*/


CREATE DATABASE EMPLEADOSISAAC
GO
USE EMPLEADOSISAAC
GO
--TABLA VIVE
CREATE TABLE VIVE

(

#NOMBRE NVARCHAR (20),

CALLE NVARCHAR(30),

CIUDAD NVARCHAR(25),

PRIMARY KEY(#NOMBRE)

)
--TABLA TRABAJA
GO
CREATE TABLE TRABAJA

(

#NOMBRE NVARCHAR (20),

#COMPAÑIA NVARCHAR (30),

SALARIO MONEY,

PRIMARY KEY(#NOMBRE)

)
GO
--TABLA SITUADA
CREATE TABLE SITUADA

(

#COMPAÑIA NVARCHAR (30),

CIUDAD NVARCHAR(25),

PRIMARY KEY (#COMPAÑIA)

)
GO
--TABLA DIRIGE
CREATE TABLE DIRIGE

( #NOMBRE NVARCHAR (20),

#NOMBRE_DIRECTOR NVARCHAR(20),

PRIMARY KEY(#NOMBRE)

)

GO
----------------------------------------------------------------------------------------------
--RELACIONES DE LAS TABLAS
ALTER TABLE VIVE ADD CONSTRAINT VIVE_DIRIGE FOREIGN KEY (#NOMBRE) REFERENCES DIRIGE (#NOMBRE)
GO
ALTER TABLE TRABAJA ADD CONSTRAINT VIVE_TRABAJA FOREIGN KEY (#NOMBRE) REFERENCES VIVE (#NOMBRE)
GO
ALTER TABLE TRABAJA ADD CONSTRAINT TRAB_DIRIGE FOREIGN KEY (#NOMBRE) REFERENCES DIRIGE (#NOMBRE)
GO
ALTER TABLE TRABAJA ADD CONSTRAINT TRAB_CIA FOREIGN KEY (#COMPAÑIA) REFERENCES SITUADA (#COMPAÑIA)
------------------------------------------------------------------------------------------------------

--INSERCIONES
--ENTOCES INSERTEMOS LOS DATOS DE DIRIGE PRIMERO

--DATOS DE DIRIGE NO DEPENDEN DE NADIE
INSERT INTO DIRIGE (#NOMBRE,#NOMBRE_DIRECTOR)VALUES ('JANSEL','JAIME')
GO
INSERT INTO DIRIGE (#NOMBRE,#NOMBRE_DIRECTOR)VALUES ('FRANK REYES','FRANK REYES')
GO
INSERT INTO DIRIGE (#NOMBRE,#NOMBRE_DIRECTOR)VALUES ('GUILLERMO','FELIPE')
GO
INSERT INTO DIRIGE (#NOMBRE,#NOMBRE_DIRECTOR)VALUES ('MARIA','FRANK REYES')
GO
--HAHAHAHAHAH EL DATO ERRADO ERA EL NOMBRE JOSE QUE NO ESTABA EN LA TABLA DIRIGE SINO EN GUILLERMO

--DATOS VIVE DEPENDE DE DIRIGE
INSERT INTO VIVE (#NOMBRE,CALLE,CIUDAD)VALUES ('JANSEL','MAXIMO GOMEZ','SANTO DOMINGO')
GO
INSERT INTO VIVE (#NOMBRE,CALLE,CIUDAD)VALUES ('FRANK REYES','AV. DUARTE','SANTIAGO')
GO
INSERT INTO VIVE (#NOMBRE,CALLE,CIUDAD)VALUES ('GUILLERMO','CARR. MELLA','SANTO DOMINGO')
GO
INSERT INTO VIVE (#NOMBRE,CALLE,CIUDAD)VALUES ('MARIA','OVANDO','SANTIAGO')
GO
--DATOS DE SITUADAS YA QUE TIENE EL CAMPO COMPAÑIA QUE RELACIONA A TRABAJA
--RECUERDA QUE TRABAJA DEPENDE DE SITUADA Y DE DIRIGE
--POR LO TANTO TRABAJA Y DIRIGE TIENEN QUE TENER DATOS PRIMERO QUE TRABAJA

INSERT INTO SITUADA (#compañia,ciudad)VALUES ('PLAZA LAMA','SANTO DOMINGO')
GO
INSERT INTO SITUADA (#compañia,ciudad)VALUES ('LA SIRENA','SANTIAGO')
GO
INSERT INTO SITUADA (#compañia,ciudad)VALUES ('LA GRAN VIA','SANTO DOMINGO')

--DATOS DE TRABAJA YA QUE DEPENDE DE DIRIGE Y DE COMPAÑIA 
--DE NUEVO EL NOMBRE JOSE APARECIO EN LA INSERCION DE DATOS DE TRABAJA A PESAR DE QUE NO ESTA EN DIRIGE
--VEAMOS COMPAÑIAS
INSERT INTO TRABAJA (#NOMBRE,#COMPAÑIA,SALARIO)VALUES ('JANSEL','PLAZA LAMA',18000)
GO
INSERT INTO TRABAJA (#NOMBRE,#COMPAÑIA,SALARIO)VALUES ('GUILLERMO','LA SIRENA',60000)
GO
INSERT INTO TRABAJA (#NOMBRE,#COMPAÑIA,SALARIO)VALUES ('FRANK REYES','LA GRAN VIA',23000)
GO
INSERT INTO TRABAJA(#NOMBRE,#COMPAÑIA,SALARIO)VALUES ('MARIA','PLAZA LAMA',75000)


--Encontrar el nombre y la ciudad de todos los empleados que trabajan en Plaza Lama.

SELECT DISTINCT TRABAJA.#NOMBRE,SITUADA.CIUDAD,TRABAJA.#COMPAÑIA FROM
TRABAJA,SITUADA WHERE SITUADA.#COMPAÑIA = 'PLAZA LAMA' AND SITUADA.#COMPAÑIA = TRABAJA.#COMPAÑIA
SELECT * FROM TRABAJA
SELECT * FROM DIRIGE

--Encontrar el salario y la compañía de todos los directores.

SELECT #NOMBRE_DIRECTOR,SALARIO FROM DIRIGE,TRABAJA
WHERE TRABAJA.#NOMBRE = DIRIGE.#NOMBRE


--Dadas las siguientes tablas relacionales:

/*

*Cigarrillo (#marca, #filtro, nombre_fabricante, precio)

Estanco (#CI, nombre, direccion)

*Fabricante (#nombre, pais)

*Compras (#CI, #marca, #filtro, ano, cantidad, precio)

*Ventas (#CI, #marca, #filtro, ano, cantidad, precio)


*/






--CREAR TABLA FABRICA_CIGARRILLOS
CREATE DATABASE FABRICA_CIGARRILLOS
GO
USE FABRICA_CIGARRILLOS
GO

--TABLA FABRICANTE
CREATE TABLE Fabricante

(#Nombre NVARCHAR(15),

Pais NVARCHAR(30),

Primary Key(#Nombre)

)

--TABLE CIGARRILLOS
CREATE TABLE CIGARRILLOS

(#Marca nvarchar(15),

#Filtro NVARCHAR(10),

Nombre_fabricante NVARCHAR(15),

Precio MONEY,

CONSTRAINT pk_fabric_cigarr Primary Key(#Marca),

CONSTRAINT FK_fabric_cigarr FOREIGN Key(Nombre_fabricante) references fabricante(#Nombre )ON DELETE CASCADE ON UPDATE CASCADE

)

--TABLA ESTANCO
CREATE TABLE Estanco

(

#CI nvarchar(5),

Nombre NVARCHAR(15),

Dirección NVARCHAR(30),

CONSTRAINT pk_Estanco_cigarr Primary Key(#CI),

CONSTRAINT FK_Estanco_cigarr FOREIGN Key(Nombre) references fabricante(#Nombre )ON DELETE CASCADE ON UPDATE CASCADE

)

--TABLA COMPRAS
create table Compras

(

#CI nvarchar(5),

#Marca nvarchar(15),

#Filtro NVARCHAR(10),

Año NUMERIC(4),

Cantidad NUMERIC(4,2),

Precio MONEY,

CONSTRAINT pk_Compras_cigarr Primary Key(#CI),

CONSTRAINT FK_Compras_cigarr FOREIGN Key(#Marca) references Cigarrillos(#Marca)ON DELETE CASCADE ON UPDATE CASCADE

)


--TABLA VENTAS
CREATE TABLE VENTAS

(

#CI nvarchar(5),

#marca nvarchar(15),

#filtro NVARCHAR(10),

Año NUMERIC(4),

Cantidad NUMERIC(4,2),

Precio MONEY,

CONSTRAINT pk_Ventas_cigarr Primary Key(#CI),

CONSTRAINT FK_Ventas_cigarr FOREIGN Key(#Marca) references Cigarrillos(#Marca)ON DELETE CASCADE ON UPDATE CASCADE

)

--INSERTANDO VALORES EN LA TABLA FABRICANTE
INSERT INTO FABRICANTE(#Nombre,Pais)VALUES('MONTE CARLO','REP.DOM')
GO
INSERT INTO FABRICANTE(#Nombre,Pais)VALUES('MALLBORO','ESPAÑA')
GO
INSERT INTO FABRICANTE(#Nombre,Pais)VALUES('AURORA','INGLATERRA')
GO
INSERT INTO FABRICANTE(#Nombre,Pais)VALUES('NACIONAL','REP.DOM')
GO
SELECT * FROM FABRICANTE



